#*******************************
# ABOUT THIS FILE
#
# sourced by both bashrc and zshrc; non-interactive shells;
# essentially, this is sourced in in *all* cases
#*******************************

set -o vi

if [ -f "$HOME/bin/agent" ]
then
  . $HOME/bin/agent
fi

umask 022

stty echoe 2>/dev/null
stty -ixon 2>/dev/null
stty flush '^@' 2>/dev/null
stty start '^@' 2>/dev/null
stty stop '^@' 2>/dev/null
stty susp '^Z' 2>/dev/null

export VISUAL="$HOME/bin/cvim"
export EDITOR="$HOME/bin/cvim"

export LESSBINFMT='*d\%o'
export LESS=-eRM
export PAGER='less'
export MANPAGER='less -isR'
export MANPATH=/usr/local/man:/usr/local/share/man:$MANPATH

# Try to sort correctly
export LANG=en_US.UTF-8
export LC_COLLATE=C

alias vim="$HOME/bin/cvim"

# Sorting issues
alias ls='LC_ALL=C ls -AF --color=auto'
alias sort='LC_ALL=C sort'

# Privacy issues
alias gist='gist -p'

# Spelling mistakes
alias les='less'
alias gerp=grep

# better default
alias tmux='TERM=xterm-256color tmux -2 -u '

# Color for grep
export GREP_OPTIONS='--color=auto'

# Yay forests
ps () {
  /bin/ps --forest -f -e "$@"
}
pg () {
  /bin/ps --forest -f -e | grep "$@"
}

# stolen from cizra in #jbopre
alias g=git
alias gd='g diff -w'
alias gdc='g diff -w --cached'
alias gs='g status --short'
alias ga='g add'
alias gf='g fetch'
alias gr='g rebase'
alias gst='g stash'
alias gp='g pull ; g push'
alias gb='g branch'
alias gc='g commit'
alias gca='g commit -a'
# alias gcah='g commit --amend -C HEAD'  # amend the last commit keeping the same commit message
alias gl='g log --pretty=format:"%Cblue%h%Creset%x09%an%x09 %ar%x09%s" --graph'
alias gin='gl ..@{u}'  # [w]hat's [i]ncoming; useful after a gf (git fetch)
alias gout='gl @{u}..'  # what's [u]npushed; useful before a gp (git push)

# ack version issues
if which ack >/dev/null 2>&1 && [ $(ack --version | head -n 1 | sed 's/\..*//' | sed 's/.* //') -eq 1 ]
then
  alias a='ack -a'
  alias ai='ack -ai'
  alias al='ack -al'
  alias ail='ack -ail'
else
  alias a='ack'
  alias ai='ack -i'
  alias al='ack -l'
  alias ail='ack -il'
fi

# Easier lsof
alias li='sudo lsof -Pnl -i | grep LIST '
alias lsof='sudo lsof -Pnl -i '

unset RUBYOPT

if [ "$(hostname)" = "vrici.digitalkingdom.org" ]
then
  . ~/.selinux_functions
else
  sefindif() { echo "Go to vrici" }
  seshowif() { echo "Go to vrici" }
  sefinddef() { echo "Go to vrici" }
  seshowdef() { echo "Go to vrici" }
  sefindcon() { echo "Go to vrici" }
  selist() { echo "Go to vrici" }
fi

# Insert the RVM path, if any, into the middle, by putting the tail
# on, attaching RVM in front, then adding more.
export PATH="/sbin:/bin:/usr/sbin:/usr/bin"

[[ -s "$HOME/.rvm/scripts/rvm" ]] && source "$HOME/.rvm/scripts/rvm" # Load RVM into a shell session *as a function*

export PATH="$HOME/bin:/root/bin:/usr/local/bin/:/usr/local/sbin:$PATH"

export LD_LIBRARY_PATH="/usr/local/lib:$LD_LIBRARY_PATH"

export TERM='screen'
